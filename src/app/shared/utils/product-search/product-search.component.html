<div class="relative search-wrapper">
  <!-- Search Icon -->
  <button (click)="toggleSearch()"
          class="text-white hover:text-gray-300 transition-colors duration-300 p-2 rounded-full hover:bg-white/10 cursor-pointer">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
      viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
      class="lucide lucide-search">
      <circle cx="11" cy="11" r="8"/>
      <path d="m21 21-4.3-4.3"/>
    </svg>
  </button>

  <!-- Search Overlay -->
  <div *ngIf="searchOpen" 
       class="absolute top-full right-0 mt-2 w-[90vw] md:w-80 bg-white rounded-lg shadow-lg z-50 p-2">

    <!-- Mobile full width -->
    <div class="block md:hidden fixed inset-0 bg-white z-50 p-4">
      <div class="flex items-center gap-2 mb-3">
        <input type="text"
               placeholder="Search products..."
               (input)="onSearch($event)"
               class="flex-1 border border-gray-300 rounded px-3 py-2 text-black focus:outline-none focus:ring-2 focus:ring-blue-500"
               autofocus />
        <button (click)="toggleSearch()" class="text-gray-600 hover:text-black">
          ✕
        </button>
      </div>

      <div class="bg-white rounded-lg shadow max-h-[70vh] overflow-y-auto">
        <ul *ngIf="filteredProducts.length > 0; else noResults" class="divide-y divide-gray-200">
          <li *ngFor="let product of filteredProducts"
              (click)="goToProduct(product.id)"
              class="flex items-center gap-3 p-2 cursor-pointer hover:bg-gray-100 rounded">
            
            <img [src]="product.imageUrls[0]" alt="{{ product.name }}"
                 class="w-10 h-10 rounded object-cover border"
                 (error)="$any($event.target).src='assets/images/Sweets/Default.jpg'">

            <div class="flex flex-col">
              <span class="font-medium text-gray-800">{{ product.name }}</span>
              <span class="text-sm text-gray-500">{{ product.category }}</span>
            </div>

            <div class="ml-auto text-blue-700 font-semibold">
              ₹{{ product.units[0].priceFactor }}
            </div>
          </li>
        </ul>

        <ng-template #noResults>
          <div *ngIf="searchTerm.length > 0" class="text-gray-500 text-sm p-2">
            No results found
          </div>
        </ng-template>
      </div>
    </div>

    <!-- Desktop (unchanged) -->
    <div class="hidden md:block">
      <input type="text"
             placeholder="Search products..."
             (input)="onSearch($event)"
             class="w-full border border-gray-300 rounded px-3 py-2 text-black focus:outline-none focus:ring-2 focus:ring-blue-500"
             autofocus />

      <div class="mt-2 bg-white rounded-lg shadow-lg max-h-64 overflow-y-auto">
        <ul *ngIf="filteredProducts.length > 0; else noResults" 
          class="mt-2 max-h-64 overflow-y-auto divide-y divide-gray-200">
        <li *ngFor="let product of filteredProducts"
            (click)="goToProduct(product.id)"
            class="flex items-center gap-3 p-2 cursor-pointer hover:bg-gray-100 rounded">
            
          <!-- Thumbnail -->
          <img [src]="product.imageUrls[0]"
               alt="{{ product.name }}"
               class="w-10 h-10 rounded object-cover border" 
               (error)="$any($event.target).src='assets/images/Sweets/Default.jpg'">
      
          <!-- Product Info -->
          <div class="flex flex-col">
            <span class="font-medium text-gray-800">{{ product.name }}</span>
            <span class="text-sm text-gray-500">{{ product.category }}</span>
          </div>
      
          <!-- Price -->
          <div class="ml-auto text-blue-700 font-semibold">
            ₹{{ product.units[0].priceFactor }}
          </div>
        </li>
      </ul>
      
        
      <ng-template #noResults>
        <div *ngIf="searchTerm.length > 0"
             class="text-gray-500 text-sm p-2">
          No results found
        </div>
      </ng-template>
      </div>
    </div>
  </div>

  
</div>
